<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DOOFYTALE - The game where mercy, mischief, and falling in love with chaos... is kinda the point.</title>
    <!-- Tailwind CSS CDN for utility-first styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts import for 'Press Start 2P' (pixel art) -->
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        /* Global Styles for Pixel Art Theme */
        body {
            font-family: 'Press Start 2P', cursive;
            background-color: #0a0a0a; /* Slightly softer black */
            color: #ffffff; /* Pure white for text */
            /* Ensure pixelated rendering for images where supported */
            image-rendering: optimizeSpeed;
            image-rendering: -moz-crisp-edges;
            image-rendering: -webkit-optimize-contrast;
            image-rendering: pixelated;
            -ms-interpolation-mode: nearest-neighbor;
            line-height: 1.5; /* Improved readability for pixel font */
            overflow-x: hidden; /* Prevent horizontal scroll on some effects */
        }

        /* Basic text shadow for readability on pixel fonts */
        .text-shadow-pixel {
            text-shadow: 2px 2px 0px rgba(0, 0, 0, 0.8);
        }

        /* Heart shape CSS for the player's soul and decorative elements */
        .heart {
            width: 32px; /* Slightly larger, more prominent */
            height: 32px;
            background-color: #ff0000; /* Vibrant red */
            transform: rotate(45deg);
            position: relative;
            animation: pulse-pixel 1.2s infinite steps(2); /* Stepped pulse for pixel feel */
            box-shadow: 0 0 0 2px #000000, 0 0 0 5px #ff0000; /* Enhanced pixelated glow effect */
        }
        
        .heart:before, .heart:after {
            content: "";
            width: 32px;
            height: 32px;
            background-color: #ff0000;
            border-radius: 0; /* Remove rounding for pixel feel */
            position: absolute;
            box-shadow: 0 0 0 2px #000000; /* Pixelated border for heart parts */
        }
        
        .heart:before {
            top: -16px;
            left: 0;
        }
        
        .heart:after {
            top: 0;
            left: -16px;
        }
        
        /* Keyframes for the pixelated heart pulse animation */
        @keyframes pulse-pixel {
            0% { transform: rotate(45deg) scale(1); }
            50% { transform: rotate(45deg) scale(1.1); }
            100% { transform: rotate(45deg) scale(1); }
        }
        
        /* Soul animation for floating effect */
        .soul-animation {
            animation: float-pixel 2.5s ease-in-out infinite steps(2); /* Stepped float */
        }
        
        /* Keyframes for the pixelated floating animation */
        @keyframes float-pixel {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-12px); } /* Slightly larger vertical movement */
            100% { transform: translateY(0px); }
        }
        
        /* Styling for game UI boxes - very blocky and high contrast */
        .game-box {
            border: 4px solid #ffffff; /* Thick, pixelated border */
            box-shadow: 8px 8px 0px rgba(0, 0, 0, 0.8); /* Strong, offset pixel shadow */
            background-color: #000000; /* Pure black */
            border-radius: 0; /* Sharp corners */
            padding: 1.5rem; /* Consistent padding */
        }
        
        /* Styling for dialogue boxes */
        .dialogue-box {
            border: 2px solid #ffffff;
            background-color: rgba(0,0,0,0.95); /* Slightly less transparent black */
            padding: 1.5rem;
            border-radius: 0;
            box-shadow: 4px 4px 0px rgba(255,255,255,0.2);
            animation: fadeIn 0.5s ease-out; /* Fade in effect */
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Button styling for a retro, clickable feel */
        .game-button {
            background-color: #000000;
            color: #ffffff;
            border: 2px solid #ffffff;
            box-shadow: 4px 4px 0px #888888; /* Softer gray for raised effect */
            transition: all 0.05s linear; /* Instant transition for pixel feel */
            border-radius: 0;
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill="white" d="M0 0h16v16H0z"/><path fill="red" d="M2 2h2v2H2zM4 4h2v2H4zM6 6h2v2H6zM8 8h2v2H8zM10 10h2v2h-2zM12 12h2v2h-2z"/></svg>') 8 8, auto; /* Pixelated cursor */
            text-transform: uppercase; /* All caps for buttons */
            padding: 0.75rem 1.5rem; /* Consistent button padding */
        }

        .game-button:hover {
            background-color: #ffffff; /* Invert colors on hover */
            color: #000000;
            box-shadow: 2px 2px 0px #000000; /* Pressed pixel button effect */
            transform: translate(2px, 2px); /* Simulate press */
        }

        .game-button:active {
            background-color: #444444; /* Darker when active */
            box-shadow: 0 0 0px #000000;
            transform: translate(4px, 4px); /* Further press */
        }
        
        /* Typing effect for dialogue */
        .typing-effect-pixel {
            overflow: hidden;
            border-right: 2px solid #ffffff; /* Pixelated blinking caret */
            white-space: nowrap;
            animation: 
                typing-pixel 3.5s steps(40, end),
                blink-caret-pixel .75s step-end infinite;
        }
        
        /* Keyframes for pixelated typing */
        @keyframes typing-pixel {
            from { width: 0 }
            to { width: 100% }
        }
        
        /* Keyframes for pixelated blinking caret */
        @keyframes blink-caret-pixel {
            from, to { border-color: transparent }
            50% { border-color: #ffffff; }
        }

        /* Character and Merch Card Styling */
        .card-base {
            background-color: #000000;
            border-radius: 0;
            border: 2px solid #ffffff;
            box-shadow: 6px 6px 0px #888888; /* Strong offset shadow */
            transition: transform 0.05s linear, box-shadow 0.05s linear;
        }
        .card-base:hover {
            transform: translate(-2px, -2px); /* Lift effect */
            box-shadow: 8px 8px 0px #ff0000; /* Brighter red shadow on hover */
        }

        /* Character image container sizing for bigger pictures */
        .character-card .card-image-container {
            height: 288px; /* Bigger image height (h-72 equivalent) */
        }

        .card-image-container {
            width: 100%;
            overflow: hidden;
            border-bottom: 2px solid #ffffff; /* Pixelated border */
            background-color: #1a1a1a; /* Darker background for image area */
        }
        .card-image-placeholder {
            width: 100%;
            height: 100%;
            object-fit: cover;
            image-rendering: pixelated;
        }

        /* Specific background colors for character cards - internal visual distinction */
        .char-sans { background-color: #111111; } 
        .char-papyrus { background-color: #222222; } 
        .char-doofy { background-color: #333333; } 
        .char-quackers { background-color: #444444; } 

        /* Specific background colors for merch cards - similar pixelated distinction */
        .merch-item-1 { background-color: #111111; } 
        .merch-item-2 { background-color: #222222; } 
        .merch-item-3 { background-color: #333333; } 

        /* Music Player Image Styling */
        .track-image-container {
            width: 140px; /* Slightly larger image container */
            height: 140px;
            overflow: hidden;
            border-radius: 0;
            border: 2px solid #ffffff;
            box-shadow: 4px 4px 0px #888888;
        }
        .track-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            image-rendering: pixelated;
        }

        /* Progress bar for music player */
        #progress-bar {
            height: 6px; /* Thicker progress bar */
            background-color: #ff0000; /* Vibrant red progress */
            border-radius: 0;
            transition: width 0.1s linear;
        }
        .progress-bar-bg {
            height: 6px; /* Thicker background bar */
            background-color: #ffffff; /* White background */
            border-radius: 0;
        }

        /* Adjust button sizes for music player controls */
        #toggle-play-pause, #prev-track-button, #next-track-button {
            font-size: 3rem; /* Even larger icons */
            color: #ffffff; /* Ensure white color */
        }
        #toggle-play-pause:hover, #prev-track-button:hover, #next-track-button:hover {
            color: #ff0000; /* Red on hover for controls */
        }

        /* Footer specific styling */
        .footer-link:hover {
            color: #ff0000; /* Red on hover for footer links */
            transition: color 0.05s linear;
        }

        /* Responsive adjustments - Mobile First */
        /* Default styles are for mobile */
        .text-5xl { font-size: 2.5rem; } /* Hero title */
        .text-7xl { font-size: 3.5rem; } /* Character icons */
        .text-8xl { font-size: 4rem; } /* Hero title on larger mobile */
        .text-xl { font-size: 1rem; } /* General headings/larger text */
        .text-lg { font-size: 0.875rem; } /* Body text */
        .text-base { font-size: 0.75rem; } /* Smaller body text */
        .text-sm { font-size: 0.625rem; } /* Smallest text */
        .text-xs { font-size: 0.5rem; } /* Very small text */

        .heart { width: 24px; height: 24px; }
        .heart:before, .heart:after { width: 24px; height: 24px; top: -12px; left: -12px; }
        .track-image-container { width: 100px; height: 100px; }
        #toggle-play-pause, #prev-track-button, #next-track-button { font-size: 2rem; }

        .game-box {
            padding: 1rem; /* Less padding on smaller screens */
        }

        /* Small devices (sm) - 640px and up */
        @media (min-width: 640px) {
            .text-5xl { font-size: 3rem; }
            .text-7xl { font-size: 4rem; }
            .text-8xl { font-size: 5rem; }
            .text-xl { font-size: 1.125rem; }
            .text-lg { font-size: 1rem; }
            .text-base { font-size: 0.875rem; }
            .text-sm { font-size: 0.75rem; }
            .text-xs { font-size: 0.625rem; }
            .heart { width: 28px; height: 28px; }
            .heart:before, .heart:after { width: 28px; height: 28px; top: -14px; left: -14px; }
            .track-image-container { width: 120px; height: 120px; }
            #toggle-play-pause, #prev-track-button, #next-track-button { font-size: 2.5rem; }
        }

        /* Medium devices (md) - 768px and up */
        @media (min-width: 768px) {
            .game-box {
                padding: 2rem; /* More padding on larger screens */
            }
            .text-5xl { font-size: 3.5rem; }
            .text-7xl { font-size: 5rem; }
            .text-8xl { font-size: 6rem; }
            .text-xl { font-size: 1.25rem; }
            .text-lg { font-size: 1.125rem; }
            .text-base { font-size: 1rem; }
            .text-sm { font-size: 0.875rem; }
            .text-xs { font-size: 0.75rem; }
            .heart { width: 32px; height: 32px; }
            .heart:before, .heart:after { width: 32px; height: 32px; top: -16px; left: -16px; }
            .track-image-container { width: 140px; height: 140px; }
            #toggle-play-pause, #prev-track-button, #next-track-button { font-size: 3rem; }
        }

        /* Large devices (lg) - 1024px and up */
        @media (min-width: 1024px) {
            .text-5xl { font-size: 4rem; }
            .text-7xl { font-size: 6rem; }
            .text-8xl { font-size: 7rem; }
            .text-xl { font-size: 1.5rem; }
            .text-lg { font-size: 1.25rem; }
            .text-base { font-size: 1.125rem; }
            .text-sm { font-size: 1rem; }
            .text-xs { font-size: 0.875rem; }
        }

        /* Extra large devices (xl) - 1280px and up */
        @media (min-width: 1280px) {
            .text-5xl { font-size: 5rem; }
            .text-7xl { font-size: 7rem; }
            .text-8xl { font-size: 8rem; }
        }

        /* Background pixelated pattern */
        .pixel-bg {
            background-image: url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"8\" height=\"8\"><rect width=\"4\" height=\"4\" fill=\"white\" opacity=\"0.05\"/><rect x=\"4\" y=\"4\" width=\"4\" height=\"4\" fill=\"white\" opacity=\"0.05\"/></svg>');
            background-size: 8px 8px;
            image-rendering: pixelated;
            animation: move-pixel-bg 60s linear infinite; /* Slow, continuous movement */
        }

        @keyframes move-pixel-bg {
            from { background-position: 0 0; }
            to { background-position: 800px 800px; } /* Move a large distance */
        }

        /* Styles for expandable character cards */
        .character-card {
            cursor: pointer; /* Indicate clickability */
        }

        .character-bio-container {
            max-height: 120px; /* Initial height for summary */
            overflow: hidden;
            transition: max-height 0.3s ease-out; /* Smooth expansion */
        }

        .character-bio-container.expanded {
            max-height: 2000px; /* Sufficiently large to show all content */
            /* Using a large fixed height for max-height transition is generally better than 'none' for smooth animation */
        }

        .toggle-icon {
            transition: transform 0.3s ease-out;
        }

        .character-bio-container.expanded .toggle-icon {
            transform: rotate(180deg); /* Rotate arrow when expanded */
        }

        /* Soundtrack Player specific styles (Modern, Elegant, Classy) */
        .modern-player-container {
            background-color: #0d0d0d; /* Very dark, almost black for elegance */
            border: 2px solid #a0a0a0; /* Softer white/gray border */
            box-shadow: 4px 4px 0px rgba(0, 0, 0, 0.6); /* More subtle shadow */
            border-radius: 0; /* Still pixelated sharp corners */
            padding: 2.5rem; /* More padding for a premium feel */
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            transition: box-shadow 0.2s ease-in-out; /* Subtle hover transition */
            position: relative; /* For gradient glow */
            overflow: hidden; /* Contain glow */
        }
        .modern-player-container::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle at center, rgba(255, 0, 0, 0.2) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.4s ease-in-out;
            pointer-events: none;
            z-index: 0; /* Behind content */
            transform: scale(0.8); /* Start smaller */
        }
        .modern-player-container:hover::before {
            opacity: 1;
            transform: scale(1); /* Expand on hover */
        }
        .modern-player-container:hover {
            box-shadow: 6px 6px 0px #ff0000; /* Pop with red on hover */
        }

        .player-image-wrapper {
            position: relative;
            width: 250px; /* Even larger image for elegance */
            height: 250px;
            margin-bottom: 2rem;
            border: 2px solid #ffffff;
            box-shadow: 4px 4px 0px #444444; /* Muted shadow for image */
            overflow: hidden;
            background-color: #000000;
        }

        .player-image-wrapper img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            image-rendering: pixelated;
        }

        .track-info {
            margin-bottom: 2rem;
        }

        .track-title {
            font-size: 1.8rem; /* Larger, more prominent title */
            margin-bottom: 0.75rem;
            color: #ffffff;
            text-shadow: 2px 2px 0px rgba(0, 0, 0, 0.8);
        }

        .track-artist {
            font-size: 1.1rem; /* Slightly larger artist name */
            color: #888888; /* Softer gray for artist */
            text-shadow: 1px 1px 0px rgba(0, 0, 0, 0.8);
        }

        .progress-bar-wrapper {
            width: 100%;
            height: 12px; /* Thicker, more substantial progress bar */
            background-color: #333333; /* Darker, more elegant background for progress bar */
            border-radius: 0;
            margin-bottom: 0.75rem;
            cursor: pointer;
            border: 1px solid #555555; /* Subtle border */
        }

        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff0000 0%, #ff7f00 50%, #ffff00 100%); /* Gradient */
            border-radius: 0;
            width: 0%;
            transition: width 0.1s linear;
        }

        .time-display {
            display: flex;
            justify-content: space-between;
            width: 100%;
            font-size: 0.9rem; /* Slightly larger time display */
            color: #888888;
            margin-bottom: 2.5rem;
        }

        .player-controls {
            display: flex;
            align-items: center;
            gap: 2.5rem; /* More space between controls for elegance */
            margin-bottom: 2rem;
        }

        .control-button {
            background: none;
            border: none;
            color: #ffffff;
            font-size: 2.8rem; /* Large icons */
            cursor: pointer;
            transition: color 0.1s linear, transform 0.05s linear;
            text-shadow: 2px 2px 0px rgba(0, 0, 0, 0.8);
        }
        .control-button:hover {
            color: #ff0000; /* Red on hover */
            transform: scale(1.08); /* Slightly more pronounced hover */
        }
        .control-button:active {
            transform: scale(0.92);
        }

        .play-pause-button {
            font-size: 4.5rem; /* Even larger play/pause */
        }

        .volume-control-wrapper {
            display: flex;
            align-items: center;
            gap: 1.2rem; /* More space for volume control */
            width: 90%; /* Wider volume slider */
            max-width: 350px;
        }

        .volume-slider {
            -webkit-appearance: none;
            width: 100%;
            height: 6px; /* Even thinner slider for modern feel */
            background: linear-gradient(90deg, #555555 0%, #888888 100%); /* Subtle gray gradient for track */
            outline: none;
            opacity: 0.9;
            transition: opacity .2s, background 0.3s ease-in-out; /* Smooth transition for background */
            border-radius: 3px; /* Slightly rounded corners for sleekness */
            cursor: pointer;
            border: none; /* No border for a cleaner look */
            box-shadow: inset 0 1px 2px rgba(0,0,0,0.5); /* Inner shadow for depth */
        }

        .volume-slider:hover {
            opacity: 1;
            background: linear-gradient(90deg, #ff0000 0%, #ff7f00 100%); /* Red gradient on hover */
        }

        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px; /* Slightly smaller thumb for sleekness */
            height: 18px;
            background: #ffffff; /* White thumb for contrast */
            cursor: pointer;
            border-radius: 50%; /* Fully rounded thumb */
            border: 2px solid #ff0000; /* Red border for thumb */
            box-shadow: 0 0 0 2px rgba(0,0,0,0.8), 0 0 5px rgba(255,0,0,0.5); /* Outer shadow with glow */
            transition: background 0.1s ease-in-out, box-shadow 0.1s ease-in-out;
        }
        .volume-slider:hover::-webkit-slider-thumb {
            background: #ff0000; /* Red thumb on hover */
            border-color: #ffffff;
            box-shadow: 0 0 0 2px rgba(0,0,0,0.8), 0 0 8px rgba(255,255,255,0.7); /* Brighter glow */
        }

        .volume-slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            background: #ffffff;
            cursor: pointer;
            border-radius: 50%;
            border: 2px solid #ff0000;
            box-shadow: 0 0 0 2px rgba(0,0,0,0.8), 0 0 5px rgba(255,0,0,0.5);
            transition: background 0.1s ease-in-out, box-shadow 0.1s ease-in-out;
        }
        .volume-slider:hover::-moz-range-thumb {
            background: #ff0000;
            border-color: #ffffff;
            box-shadow: 0 0 0 2px rgba(0,0,0,0.8), 0 0 8px rgba(255,255,255,0.7);
        }

        /* Simple visualizer (removed from HTML, but keeping styles if re-added) */
        .visualizer {
            display: none; /* Hide visualizer */
            justify-content: center;
            align-items: flex-end;
            width: 100%;
            height: 60px; /* Taller visualizer */
            gap: 6px; /* More space between bars */
            margin-top: 2rem;
            border-top: 2px solid #a0a0a0; /* Softer border */
            padding-top: 10px;
        }

        .visualizer-bar {
            width: 10px; /* Wider bars */
            background-color: #ff0000;
            animation: visualize 0.8s ease-in-out infinite alternate;
            border-radius: 0;
            box-shadow: 1px 1px 0px rgba(0,0,0,0.5);
        }

        .visualizer-bar:nth-child(1) { height: 30%; animation-delay: 0s; }
        .visualizer-bar:nth-child(2) { height: 60%; animation-delay: 0.1s; }
        .visualizer-bar:nth-child(3) { height: 40%; animation-delay: 0.2s; }
        .visualizer-bar:nth-child(4) { height: 70%; animation-delay: 0.3s; }
        .visualizer-bar:nth-child(5) { height: 50%; animation-delay: 0.4s; }
        .visualizer-bar:nth-child(6) { height: 20%; animation-delay: 0.5s; }
        .visualizer-bar:nth-child(7) { height: 80%; animation-delay: 0.6s; }
        .visualizer-bar:nth-child(8) { height: 45%; animation-delay: 0.7s; }

        @keyframes visualize {
            0% { transform: scaleY(0.5); opacity: 0.7; }
            100% { transform: scaleY(1); opacity: 1; }
        }
        .visualizer.paused .visualizer-bar {
            animation-play-state: paused;
            height: 20%; /* Keep bars low when paused */
            opacity: 0.5;
        }

        /* New styles for About section fun redesign */
        .about-image-container {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            min-height: 400px;
            padding: 1rem;
            flex-direction: column; /* Stack elements vertically */
        }

        .about-image-frame {
            border: 4px solid #ffffff;
            box-shadow: 8px 8px 0px rgba(0, 0, 0, 0.8);
            background-color: #000000;
            border-radius: 0;
            padding: 1rem;
            width: 100%;
            max-width: 400px; /* Constrain image width */
            margin-bottom: 2rem; /* Space between image and save point */
            position: relative; /* For the subtle glow */
            overflow: hidden; /* Ensure content doesn't spill */
        }

        .about-image-frame::before {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at center, rgba(255,255,255,0.1) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            pointer-events: none; /* Allow clicks to pass through */
        }

        .about-image-frame:hover::before {
            opacity: 1; /* Subtle glow on hover */
        }

        .save-point {
            width: 100px;
            height: 100px;
            background-color: #00ff00; /* Bright green for save point */
            border: 4px solid #ffffff;
            box-shadow: 6px 6px 0px #00cc00; /* Green shadow */
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.5rem;
            color: #000000;
            text-shadow: 1px 1px 0px rgba(255,255,255,0.5);
            animation: save-point-pulse 1.5s infinite steps(2) alternate; /* Pulsing animation */
            cursor: pointer;
            z-index: 10;
        }

        .save-point::before {
            content: 'SAVE';
            position: absolute;
            font-size: 1rem;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #000000;
        }

        @keyframes save-point-pulse {
            0% { transform: scale(1); box-shadow: 6px 6px 0px #00cc00; }
            100% { transform: scale(1.05); box-shadow: 8px 8px 0px #00ff00; }
        }

        .about-text-container {
            position: relative;
            z-index: 5; /* Ensure text is above any background elements */
        }

        /* Merch Section New Styles */
        .merch-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); /* Responsive grid */
            gap: 2.5rem; /* Increased gap */
        }

        .merch-card {
            background-color: #1a1a1a; /* Darker background */
            border: 3px solid #ffffff; /* Thicker white border */
            box-shadow: 8px 8px 0px #555555; /* More pronounced shadow */
            border-radius: 0;
            transition: transform 0.15s ease-out, box-shadow 0.15s ease-out;
            position: relative;
            overflow: hidden;
            cursor: pointer; /* Indicate clickability */
        }

        .merch-card:hover {
            transform: translateY(-8px) rotateZ(1deg); /* Lift and slight rotation */
            box-shadow: 12px 12px 0px #ff0000; /* Red pop shadow */
        }

        .merch-card-image-container {
            width: 100%;
            height: 220px; /* Consistent image height */
            overflow: hidden;
            border-bottom: 3px solid #ffffff;
            background-color: #000000;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .merch-card-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            image-rendering: pixelated;
            transition: transform 0.3s ease-out;
        }

        .merch-card:hover .merch-card-image {
            transform: scale(1.05); /* Slight zoom on hover */
        }

        .merch-card-content {
            padding: 1.5rem;
            text-align: center;
        }

        .merch-card-title {
            font-size: 1.8rem; /* Larger title */
            margin-bottom: 0.75rem;
            color: #ffffff;
            text-shadow: 2px 2px 0px rgba(0, 0, 0, 0.8);
        }

        .merch-card-description {
            font-size: 0.9rem; /* Slightly smaller description for compactness */
            color: #cccccc;
            margin-bottom: 1.5rem;
            /* Removed min-height and display: flex to allow natural flow */
            text-shadow: 1px 1px 0px rgba(0, 0, 0, 0.8);
            text-align: left; /* Align text left within the description block */
            line-height: 1.6; /* Improve readability for dense text */
        }
        .merch-card-description p {
            margin-bottom: 0.5rem; /* Space between paragraphs */
        }
        .merch-card-description p:last-child {
            margin-bottom: 0; /* No margin after last paragraph */
        }
        .merch-card-description .desc-label {
            font-weight: bold;
            color: #ff6666; /* A slightly softer red for labels */
            display: block; /* Ensure labels are on their own line */
            margin-top: 0.75rem; /* Space above labels */
            margin-bottom: 0.25rem; /* Small space below label */
        }
        .merch-card-description .desc-label:first-child {
            margin-top: 0; /* No top margin for the very first label */
        }


        .merch-card-price {
            font-size: 1.5rem; /* Prominent price */
            font-weight: bold;
            color: #00ff00; /* Green for positive/free items */
            margin-bottom: 1.5rem;
            text-shadow: 2px 2px 0px rgba(0, 0, 0, 0.8);
        }
        .merch-card-price.red-text {
            color: #ff0000; /* Red for special items */
        }

        .merch-button {
            background-color: #000000;
            color: #00ff00; /* Green text for action */
            border: 2px solid #00ff00;
            box-shadow: 4px 4px 0px #009900; /* Green shadow */
            transition: all 0.1s linear;
            border-radius: 0;
            cursor: pointer;
            text-transform: uppercase;
            padding: 0.8rem 2rem;
            font-size: 1rem;
        }

        .merch-button:hover {
            background-color: #00ff00;
            color: #000000;
            box-shadow: 2px 2px 0px #000000;
            transform: translate(2px, 2px);
        }

        .merch-button:active {
            background-color: #00cc00;
            box-shadow: 0 0 0px #000000;
            transform: translate(4px, 4px);
        }

        /* Specific item background patterns/colors */
        .merch-card-1 { background-image: url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\"><rect width=\"8\" height=\"8\" fill=\"#111111\"/><rect x=\"8\" y=\"8\" width=\"8\" height=\"8\" fill=\"#111111\"/><rect x=\"8\" width=\"8\" height=\"8\" fill=\"#222222\"/><rect y=\"8\" width=\"8\" height=\"8\" fill=\"#222222\"/></svg>'); background-size: 16px 16px; }
        .merch-card-2 { background-image: url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"12\"><circle cx=\"6\" cy=\"6\" r=\"4\" fill=\"#222222\"/><rect x=\"0\" y=\"0\" width=\"12\" height=\"12\" fill=\"#333333\" opacity=\"0.5\"/></svg>'); background-size: 12px 12px; }
        .merch-card-3 { background-image: url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\"><polygon points=\"10,0 0,20 20,20\" fill=\"#333333\"/><rect x=\"0\" y=\"0\" width=\"20\" height=\"20\" fill=\"#444444\" opacity=\"0.5\"/></svg>'); background-size: 20px 20px; }

        /* General subtle animations for elements */
        .animate-pulse-subtle {
            animation: pulse-subtle 3s infinite ease-in-out;
        }
        @keyframes pulse-subtle {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.9; }
        }

        .animate-float-subtle {
            animation: float-subtle 4s infinite ease-in-out;
        }
        @keyframes float-subtle {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .animate-bounce-subtle {
            animation: bounce-subtle 2s infinite ease-in-out;
        }
        @keyframes bounce-subtle {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }
    </style>
</head>
<body class="bg-black text-white min-h-screen">
    <!-- Navigation Bar -->
    <nav class="game-box py-4 px-6 flex justify-between items-center sticky top-0 z-50">
        <!-- Site Title -->
        <div class="text-white text-xl md:text-2xl text-shadow-pixel animate-pulse-subtle">
            <span class="text-white">DOOFY</span><span class="text-gray-400">TALE</span>
        </div>
        <!-- Desktop Navigation Links -->
        <div class="hidden md:flex space-x-6">
            <a href="#about" class="game-button px-4 py-2 text-shadow-pixel">ABOUT</a>
            <a href="#characters" class="game-button px-4 py-2 text-shadow-pixel">CHARACTERS</a>
            <a href="#soundtrack" class="game-button px-4 py-2 text-shadow-pixel">SOUNDTRACK</a>
            <a href="#merch" class="game-button px-4 py-2 text-shadow-pixel">MERCH</a>
        </div>
        <!-- Mobile Menu Button -->
        <button id="mobile-menu-button" class="md:hidden text-white focus:outline-none game-button p-2">
            <i class="fas fa-bars text-2xl"></i>
        </button>
        <!-- Mobile Navigation Menu (hidden by default) -->
        <div id="mobile-menu" class="hidden md:hidden absolute top-full left-0 w-full game-box shadow-lg">
            <a href="#about" class="block px-6 py-3 text-white hover:bg-white hover:text-black transition-none text-shadow-pixel">ABOUT</a>
            <a href="#characters" class="block px-6 py-3 text-white hover:bg-white hover:text-black transition-none text-shadow-pixel">CHARACTERS</a>
            <a href="#soundtrack" class="block px-6 py-3 text-white hover:bg-white hover:text-black transition-none text-shadow-pixel">SOUNDTRACK</a>
            <a href="#merch" class="block px-6 py-3 text-white hover:bg-white hover:text-black transition-none text-shadow-pixel">MERCH</a>
        </div>
    </nav>

    <!-- Main Content Wrapper -->
    <div id="main-content" class="pixel-bg">
        <!-- Hero Section -->
        <section class="relative h-screen flex items-center justify-center bg-black overflow-hidden px-4">
            <!-- Background decorative elements (simple pixel noise or subtle pattern) -->
            <div class="absolute inset-0 opacity-10" style="background-image: url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"4\" height=\"4\"><rect width=\"2\" height=\"2\" fill=\"white\" opacity=\"0.1\"/><rect x=\"2\" y=\"2\" width=\"2\" height=\"2\" fill=\"white\" opacity=\"0.1\"/></svg>'); background-size: 4px 4px; image-rendering: pixelated;"></div>
            <!-- Hero content -->
            <div class="text-center z-10 py-8 w-full max-w-4xl mx-auto">
                <h1 class="text-5xl md:text-7xl lg:text-8xl mb-6 typing-effect-pixel text-shadow-pixel">
                    <span class="text-white">DOOFY</span><span class="text-gray-400">TALE</span>
                </h1>
                <p class="mb-4 text-lg md:text-xl max-w-2xl mx-auto text-gray-200 text-shadow-pixel animate-float-subtle">WELCOME TO DOOFYTALE: WHERE YOUR HEART IS HUGE, THE PUZZLES ARE... PUZZLING, AND EVERYONE'S A LITTLE BIT CHAOTIC. (ESPECIALLY DOOFY.)</p>
                <p class="text-base md:text-lg text-gray-500 mb-10 text-shadow-pixel animate-bounce-subtle">A BIRTHDAY ADVENTURE FOR THE LEGENDARY QUACKERS! PREPARE FOR FEELS, FUN, AND MAYBE A FEW ACCIDENTAL FIGHTS.</p>
                <div class="flex flex-col md:flex-row justify-center gap-6">
                    <!-- Changed from button to anchor tag linking to game.html -->
                    <a href="game.html" class="game-button px-10 py-5 text-lg text-shadow-pixel">
                        PLAY NOW
                    </a>
                    <button class="game-button px-10 py-5 text-lg text-shadow-pixel">
                        WATCH TRAILER
                    </button>
                </div>
            </div>
            <!-- Animated heart at the bottom -->
            <div class="absolute bottom-10 left-1/2 transform -translate-x-1/2 soul-animation">
                <div class="heart"></div>
            </div>
        </section>

        <!-- About Section -->
        <section id="about" class="py-24 px-6 bg-black border-t-4 border-white">
            <div class="max-w-6xl mx-auto">
                <h2 class="text-4xl md:text-5xl mb-16 text-center text-white text-shadow-pixel">ABOUT THE GAME</h2>
                <div class="grid md:grid-cols-2 gap-16 items-center">
                    <!-- Game description -->
                    <div class="game-box dialogue-box about-text-container animate-pulse-subtle">
                        <p class="mb-6 text-lg leading-relaxed text-gray-300 text-shadow-pixel">SO, WHAT'S DOOFYTALE? IT'S DOOFY'S LOVE LETTER TO QUACKERS, WRITTEN IN PIXELS AND PURE, UNADULTERATED CHAOS. THINK UNDERTALE, BUT WITH MORE INSIDE JOKES AND A SLIGHTLY HIGHER CHANCE OF ACCIDENTALLY HUGGING A MONSTER.</p>
                        <p class="mb-6 text-lg leading-relaxed text-gray-300 text-shadow-pixel">WE'VE GOT FRIENDSHIP, FROLIC, AND THE OCCASIONAL EXISTENTIAL CRISIS (USUALLY OVER SPAGHETTI). QUACKERS, BEING THE SMART ONE, WILL NAVIGATE THE UNDERGROUND WITH GRACE AND STRATEGY. DOOFY? HE'LL BE THERE, PROBABLY TRIPPING OVER A ROCK OR TRYING TO PET A GLITCH.</p>
                        <p class="text-lg leading-relaxed text-gray-300 text-shadow-pixel">IT'S A JOURNEY OF MERCY, MISCHIEF, AND PROOF THAT EVEN THE CLUMSIEST SOUL CAN FIND THEIR WAY HOME. THIS PAGE IS A SAVE POINT FOR ALL THE GOOD TIMES. GRAB A BUTTERSCOTCH PIE AND GET READY. NYEH HEH HEH! 🧡</p>
                    </div>
                    <!-- Poster and Save Point -->
                    <div class="about-image-container"> 
                        <div class="about-image-frame">
                            <img src="UT1.png" alt="About Game Poster" class="card-image-placeholder" onerror="this.onerror=null;this.src='https://placehold.co/400x400/000/FFF?text=DOOFYTALE+POSTER';">
                        </div>
                        <div class="save-point" id="save-point-button"></div>
                        <!-- Animated soul outside the box -->
                        <div class="absolute -bottom-8 -right-8 w-28 h-28 soul-animation hidden md:block">
                            <div class="heart"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Characters Section -->
        <section id="characters" class="py-24 px-6 bg-black border-t-4 border-white">
            <div class="max-w-6xl mx-auto">
                <h2 class="text-4xl md:text-5xl mb-8 text-center text-white text-shadow-pixel">MEET THE CHARACTERS</h2>
                <!-- Hint for expandable cards -->
                <p class="text-center text-lg text-gray-500 mb-16 text-shadow-pixel">
                    CLICK ON A CHARACTER CARD FOR MORE DETAILS! <i class="fas fa-hand-pointer animate-pulse text-red-500"></i>
                </p>
                <div class="grid sm:grid-cols-1 md:grid-cols-2 gap-8">
                    <!-- Character Card: Sans -->
                    <div class="card-base character-card animate-float-subtle">
                        <div class="card-image-container char-sans flex items-center justify-center border-b-2 border-white">
                            <img src="UT2.png" alt="Sans Character Image" class="card-image-placeholder" onerror="this.onerror=null;this.src='https://placehold.co/288x288/111/FFF?text=SANS';">
                        </div>
                        <div class="p-6">
                            <h3 class="text-2xl mb-3 text-white text-shadow-pixel">SANS</h3>
                            <div class="character-bio-container text-gray-300 text-base leading-relaxed text-shadow-pixel">
                                <p><span class="font-bold text-red-400 block mb-1">TITLE:</span> THE LAZY LEGEND (AND PUN MASTER)</p>
                                <p><span class="font-bold text-red-400 block mb-1">BIO:</span> HE'S GOT A SMILE AS WIDE AS HIS LAZINESS IS DEEP. SANS IS THE KIND OF GUY WHO'LL OFFER YOU A HOT DOG, THEN TELL YOU A PUN SO BAD IT RESETS YOUR HP. DON'T LET THE SLEEPY EYES FOOL YOU; HE'S GOT SECRETS... AND PROBABLY A STASH OF KETCHUP. HE'S THE BEST BROTHER A TALL SKELETON COULD ASK FOR, EVEN IF HE FORGETS TO PAY HIS SHARE OF THE RENT.</p>
                                <p><span class="font-bold text-red-400 block mb-1 mt-3">SPECIAL MOVE:</span> GASTER BLASTER GLARE (AND A SNEAKY SHORTCUT)</p>
                                <p><span class="font-bold text-red-400 block mb-1">LIKES:</span> NAPPING, KETCHUP, BREAKING THE FOURTH WALL</p>
                                <p><span class="font-bold text-red-400 block mb-1">DISLIKES:</span> WORK, EXERCISE, PAPYRUS'S COOKING (SHHH!)</p>
                            </div>
                            <p class="text-gray-500 text-sm cursor-pointer toggle-bio block mt-4 text-right">
                                ...READ MORE <i class="fas fa-chevron-down toggle-icon"></i>
                            </p>
                        </div>
                    </div>
                    
                    <!-- Character Card: Papyrus -->
                    <div class="card-base character-card animate-float-subtle" style="animation-delay: 0.1s;">
                        <div class="card-image-container char-papyrus flex items-center justify-center border-b-2 border-white">
                            <img src="UT3.png" alt="Papyrus Character Image" class="card-image-placeholder" onerror="this.onerror=null;this.src='https://placehold.co/288x288/222/FFF?text=PAPYRUS';">
                        </div>
                        <div class="p-6">
                            <h3 class="text-2xl mb-3 text-white text-shadow-pixel">PAPYRUS</h3>
                            <div class="character-bio-container text-gray-300 text-base leading-relaxed text-shadow-pixel">
                                <p><span class="font-bold text-red-400 block mb-1">TITLE:</span> THE GREAT PAPYRUS! (AND SPAGHETTI AFICIONADO)</p>
                                <p><span class="font-bold text-red-400 block mb-1">BIO:</span> NYEH HEH HEH! PREPARE TO BE AMAZED BY THE MAGNIFICENT PAPYRUS! THIS SKELETON IS ALL ABOUT PUZZLES, PIZAZZ, AND PERFECTLY ALIGNED PASTA. HE'S DETERMINED TO JOIN THE ROYAL GUARD, BUT FIRST, HE MUST MASTER THE ART OF... MAKING FRIENDS? AND MAYBE NOT TRIPPING OVER HIS OWN CAPE. HIS HEART IS AS BIG AS HIS AMBITIONS, AND HIS SPAGHETTI IS... AN EXPERIENCE.</p>
                                <p><span class="font-bold text-red-400 block mb-1 mt-3">SPECIAL MOVE:</span> INCREDIBLY DIFFICULT (BUT FAIR!) BLUE ATTACKS</p>
                                <p><span class="font-bold text-red-400 block mb-1">LIKES:</span> SPAGHETTI, PUZZLES, HIS COOL SCARF, HIMSELF (OBVIOUSLY)</p>
                                <p><span class="font-bold text-red-400 block mb-1">DISLIKES:</span> SOCKS ON THE FLOOR, SANS'S PUNS, UNDERCOOKED PASTA</p>
                            </div>
                            <p class="text-gray-500 text-sm cursor-pointer toggle-bio block mt-4 text-right">
                                ...READ MORE <i class="fas fa-chevron-down toggle-icon"></i>
                            </p>
                        </div>
                    </div>
                    
                    <!-- Character Card: Doofy -->
                    <div class="card-base character-card animate-float-subtle" style="animation-delay: 0.2s;">
                        <div class="card-image-container char-doofy flex items-center justify-center border-b-2 border-white">
                            <img src="UT4.png" alt="Doofy Character Image" class="card-image-placeholder" onerror="this.onerror=null;this.src='https://placehold.co/288x288/333/FFF?text=DOOFY';">
                        </div>
                        <div class="p-6">
                            <h3 class="text-2xl mb-3 text-white text-shadow-pixel">DOOFY</h3>
                            <div class="character-bio-container text-gray-300 text-base leading-relaxed text-shadow-pixel">
                                <p><span class="font-bold text-red-400 block mb-1">TITLE:</span> THE ADORABLY CLUMSY HERO (PLAYER 2 EXTRAORDINAIRE)</p>
                                <p><span class="font-bold text-red-400 block mb-1">BIO:</span> DOOFY MEANS WELL. REALLY. HE'S THE HEART OF THE TEAM, EVEN IF HIS COORDINATION IS... A WORK IN PROGRESS. EXPECT DRAMATIC ENTRANCES, ACCIDENTAL BUTTON MASHES, AND HUGS SO POWERFUL THEY MIGHT JUST SOLVE A PUZZLE. HE'S GOT MORE LOVE THAN LOGIC, AND HE'S ALWAYS READY TO SUPPORT QUACKERS, EVEN IF IT MEANS FALLING INTO EVERY PIT TRAP.</p>
                                <p><span class="font-bold text-red-400 block mb-1 mt-3">SPECIAL MOVE:</span> EMPATHY OVERLOAD & UNINTENTIONAL COMEDY</p>
                                <p><span class="font-bold text-red-400 block mb-1">LIKES:</span> QUACKERS, RICE (ESPECIALLY IF QUACKERS COOKED IT), SNUGGLES, FRIENDSHIP</p>
                                <p><span class="font-bold text-red-400 block mb-1">DISLIKES:</span> PERFECTIONISM, JUMPING PUZZLES, BEING TOLD HE'S WRONG (HE'S TRYING!)</p>
                            </div>
                            <p class="text-gray-500 text-sm cursor-pointer toggle-bio block mt-4 text-right">
                                ...READ MORE <i class="fas fa-chevron-down toggle-icon"></i>
                            </p>
                        </div>
                    </div>
                    
                    <!-- Character Card: Quackers -->
                    <div class="card-base character-card animate-float-subtle" style="animation-delay: 0.3s;">
                        <div class="card-image-container char-quackers flex items-center justify-center border-b-2 border-white">
                            <img src="UT5.png" alt="Quackers Character Image" class="card-image-placeholder" onerror="this.onerror=null;this.src='https://placehold.co/288x288/444/FFF?text=QUACKERS';">
                        </div>
                        <div class="p-6">
                            <h3 class="text-2xl mb-3 text-white text-shadow-pixel">QUACKERS</h3>
                            <div class="character-bio-container text-gray-300 text-base leading-relaxed text-shadow-pixel">
                                <p><span class="font-bold text-red-400 block mb-1">TITLE:</span> THE STRATEGIC MASTERMIND (AND BIRTHDAY QUEEN!)</p>
                                <p><span class="font-bold text-red-400 block mb-1">BIO:</span> MEET QUACKERS: THE BRAINS, THE BEAUTY, THE BOSS. SHE'S THE ONE WHO ACTUALLY UNDERSTANDS THE PUZZLES, REMEMBERS THE PATTERNS, AND CARRIES THE ENTIRE OPERATION WITH A SINGLE, CONFIDENT QUACK. WHILE DOOFY'S BUSY MASHING BUTTONS, QUACKERS IS ALREADY FIVE STEPS AHEAD, CALCULATING THE OPTIMAL PATH TO VICTORY. SHE'S PATIENT, BRILLIANT, AND DESERVES ALL THE STARS IN THE UNIVERSE.</p>
                                <p><span class="font-bold text-red-400 block mb-1 mt-3">SPECIAL MOVE:</span> UNMATCHED STRATEGY & THE ULTIMATE CLUTCH SAVE</p>
                                <p><span class="font-bold text-red-400 block mb-1">LIKES:</span> ACHIEVING 3-STARS, PERFECTLY COOKED RICE, DOOFY'S ENDEARING CHAOS, BIRTHDAY CAKE</p>
                                <p><span class="font-bold text-red-400 block mb-1">DISLIKES:</span> UNNECESSARY DRAMA, LAG SPIKES, MISSING A SINGLE STAR</p>
                            </div>
                            <p class="text-gray-500 text-sm cursor-pointer toggle-bio block mt-4 text-right">
                                ...READ MORE <i class="fas fa-chevron-down toggle-icon"></i>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Soundtrack Section -->
        <section id="soundtrack" class="py-24 px-6 bg-black border-t-4 border-white">
            <div class="max-w-6xl mx-auto">
                <h2 class="text-4xl md:text-5xl mb-16 text-center text-white text-shadow-pixel">SOUNDTRACK</h2>
                <div class="grid md:grid-cols-2 gap-16 items-center">
                    <!-- Soundtrack description and top tracks list -->
                    <div class="game-box dialogue-box">
                        <p class="mb-8 text-lg leading-relaxed text-gray-300 text-shadow-pixel">DOOFY MADE THESE SONGS JUST FOR QUACKERS, LITTLE LOVE LETTERS WRAPPED IN CHIPTUNE AND CHARM. INSPIRED BY THE HEART AND HUMOUR OF UNDERTALE, EACH MELODY TELLS THEIR STORY: THE GIGGLES, THE TEAMWORK, THE BOSS BATTLES AND ALL THE SWEET MOMENTS IN BETWEEN. IT'S MUSIC FOR PLAYER ONE, FROM PLAYER TWO.</p>
                        <div class="game-box p-6">
                            <h3 class="text-xl mb-4 text-white text-shadow-pixel">TOP TRACKS</h3>
                            <ul class="space-y-4">
                                <li class="flex items-center justify-between border-b-2 border-gray-700 pb-3">
                                    <span class="text-lg text-gray-300 text-shadow-pixel">1. ONE SOUL, ONE CAKE</span>
                                    <button class="play-track-button game-button px-5 py-2 text-sm" data-track-index="0">PLAY</button>
                                </li>
                                <li class="flex items-center justify-between border-b-2 border-gray-700 pb-3">
                                    <span class="text-lg text-gray-300 text-shadow-pixel">2. QUACKSTEP WALTZ</span>
                                    <button class="play-track-button game-button px-5 py-2 text-sm" data-track-index="1">PLAY</button>
                                </li>
                                <li class="flex items-center justify-between border-b-2 border-gray-700 pb-3">
                                    <span class="text-lg text-gray-300 text-shadow-pixel">3. DISH DUTY HERO</span>
                                    <button class="play-track-button game-button px-5 py-2 text-sm" data-track-index="2">PLAY</button>
                                </li>
                                <li class="flex items-center justify-between border-b-2 border-gray-700 pb-3">
                                    <span class="text-lg text-gray-300 text-shadow-pixel">4. FEATHER VS FLUFF</span>
                                    <button class="play-track-button game-button px-5 py-2 text-sm" data-track-index="3">PLAY</button>
                                </li>
                                <li class="flex items-center justify-between pt-1">
                                    <span class="text-lg text-gray-300 text-shadow-pixel">5. DUAL SOUL MODE</span>
                                    <button class="play-track-button game-button px-5 py-2 text-sm" data-track-index="4">PLAY</button>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <!-- Modern & Elegant Music Player -->
                    <div class="flex items-center justify-center">
                        <div class="modern-player-container w-full max-w-md">
                            <div class="player-image-wrapper">
                                <img id="track-image" src="https://placehold.co/250x250/000/FFF?text=TRACK" alt="Current Track Image">
                            </div>
                            <div class="track-info">
                                <h3 id="now-playing-track-name" class="track-title">SELECT A TRACK TO PLAY</h3>
                                <p id="now-playing-artist" class="track-artist">DOOFY & QUACKERS</p>
                            </div>
                            <div class="progress-bar-wrapper" id="progress-bar-wrapper">
                                <div id="progress-bar" class="progress-bar-fill"></div>
                            </div>
                            <div class="time-display">
                                <span id="current-time">0:00</span>
                                <span id="total-time">0:00</span>
                            </div>
                            <div class="player-controls">
                                <button id="prev-track-button" class="control-button"><i class="fas fa-step-backward"></i></button>
                                <button id="toggle-play-pause" class="control-button play-pause-button"><i class="fas fa-play"></i></button>
                                <button id="next-track-button" class="control-button"><i class="fas fa-step-forward"></i></button>
                            </div>
                            <div class="volume-control-wrapper">
                                <i class="fas fa-volume-down text-white text-xl"></i>
                                <input type="range" id="volume-slider" class="volume-slider" min="0" max="1" step="0.01" value="1">
                                <i class="fas fa-volume-up text-white text-xl"></i>
                            </div>
                            <!-- Visualizer removed -->
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Merch Section -->
        <section id="merch" class="py-24 px-6 bg-black border-t-4 border-white">
            <div class="max-w-6xl mx-auto">
                <h2 class="text-4xl md:text-5xl mb-6 text-center text-white text-shadow-pixel">SANS'S BARGAIN BIN OF WONDERS!</h2>
                <p class="text-center text-lg text-gray-400 mb-16 text-shadow-pixel">(NO REFUNDS, KID. IT'S ALL PART OF THE FUN.)</p>
                
                <div class="merch-grid">
                    <!-- Item 1: The Birthday Buff -->
                    <div class="merch-card merch-card-1 animate-bounce-subtle">
                        <div class="merch-card-image-container">
                            <img src="UT6.png" alt="The Birthday Buff" class="merch-card-image" onerror="this.onerror=null;this.src='https://placehold.co/300x220/111/FFF?text=BIRTHDAY+BUFF';">
                        </div>
                        <div class="merch-card-content">
                            <h3 class="merch-card-title">THE BIRTHDAY BUFF</h3>
                            <div class="merch-card-description">
                                <p><span class="desc-label">EFFECT:</span> Grants the user an immediate surge of DETERMINATION and a +999 boost to CHARM. Makes Quackers's birthday wishes come true (probably). Side effect: May cause an uncontrollable urge to share butterscotch pie.</p>
                                <p><span class="desc-label">POWER:</span> OVERWHELMING JOY</p>
                                <p><span class="desc-label">USE:</span> Best used on special occasions, or whenever you need a smile that could reset the timeline. (Warning: May attract hungry Papyruses.)</p>
                            </div>
                            <span class="merch-card-price">ABSOLUTELY FREE! (A STEAL, HUH?)</span>
                            <button class="merch-button">CLAIM YOUR BLESSING</button>
                        </div>
                    </div>
                    
                    <!-- Item 2: The Doofy Soul -->
                    <div class="merch-card merch-card-2 animate-bounce-subtle" style="animation-delay: 0.1s;">
                        <div class="merch-card-image-container">
                            <img src="UT7.png" alt="The Doofy Soul" class="merch-card-image" onerror="this.onerror=null;this.src='https://placehold.co/300x220/222/FFF?text=DOOFY+SOUL';">
                        </div>
                        <div class="merch-card-content">
                            <h3 class="merch-card-title">THE DOOFY SOUL</h3>
                            <div class="merch-card-description">
                                <p><span class="desc-label">EFFECT:</span> A pure, albeit slightly clumsy, SOUL. Increases MERCY stat by a significant margin. May occasionally cause minor glitches in reality, like misplaced socks or spontaneously appearing spaghetti.</p>
                                <p><span class="desc-label">POWER:</span> UNCONDITIONAL AFFECTION</p>
                                <p><span class="desc-label">USE:</span> For those who believe in the power of hugs over violence. Warning: Not recommended for precision platforming sections or intense bullet-hells.</p>
                            </div>
                            <span class="merch-card-price red-text">PRICELESS (SERIOUSLY, DON'T ASK)</span>
                            <button class="merch-button">EMBRACE THE CHAOS</button>
                        </div>
                    </div>
                    
                    <!-- Item 3: Tactical Duck Energy -->
                    <div class="merch-card merch-card-3 animate-bounce-subtle" style="animation-delay: 0.2s;">
                        <div class="merch-card-image-container">
                            <img src="UT8.png" alt="Tactical Duck Energy" class="merch-card-image" onerror="this.onerror=null;this.src='https://placehold.co/300x220/333/FFF?text=TACTICAL+DUCK';">
                        </div>
                        <div class="merch-card-content">
                            <h3 class="merch-card-title">TACTICAL DUCK ENERGY</h3>
                            <div class="merch-card-description">
                                <p><span class="desc-label">EFFECT:</span> Infuses the user with QUACKERS's legendary strategic insight. Increases INTELLECT and CRITICAL THINKING. Puzzles become mere suggestions. Side effect: May cause an irresistible urge to organize everything, including Sans's sock drawer.</p>
                                <p><span class="desc-label">POWER:</span> UNMATCHED STRATEGY</p>
                                <p><span class="desc-label">USE:</span> When facing a particularly tricky boss battle, or when Doofy needs a gentle (or not-so-gentle) nudge in the right direction. (Pairs well with a perfectly cooked rice dish.)</p>
                            </div>
                            <span class="merch-card-price">LEGENDARY (WORTH AT LEAST 100G)</span>
                            <button class="merch-button">ACQUIRE WISDOM</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Next Adventure Button Section -->
        <section class="py-16 px-6 bg-black border-t-4 border-white text-center">
            <button id="next-adventure-button" class="game-button px-10 py-5 text-lg text-shadow-pixel">
                READY FOR THE NEXT LEVEL?
            </button>
        </section>

        <!-- Footer -->
        <footer class="game-box py-16 px-6">
            <div class="max-w-6xl mx-auto">
                <div class="grid md:grid-cols-3 gap-12 text-center md:text-left">
                    <!-- Site branding and tagline -->
                    <div>
                        <h3 class="text-2xl md:text-3xl mb-5 text-white text-shadow-pixel">
                            <span class="text-white">DOOFY</span><span class="text-gray-400">TALE</span>
                        </h3>
                        <p class="text-gray-500 text-base leading-relaxed text-shadow-pixel">A LOVE LETTER IN PIXELS. FOR QUACKERS, FROM DOOFY. (AND MAYBE A FEW FRIENDLY MONSTERS.)</p>
                    </div>
                    <!-- Quick Links -->
                    <div>
                        <h3 class="text-xl mb-5 text-white text-shadow-pixel">QUICK LINKS</h3>
                        <ul class="space-y-3">
                            <li><a href="#" class="text-gray-400 hover:text-red-500 transition-none text-shadow-pixel footer-link">OFFICIAL WEBSITE</a></li>
                            <li><a href="#" class="text-gray-400 hover:text-red-500 transition-none text-shadow-pixel footer-link">TOBY FOX</a></li>
                            <li><a href="#" class="text-gray-400 hover:text-red-500 transition-none text-shadow-pixel footer-link">STEAM PAGE</a></li>
                            <li><a href="#" class="text-gray-400 hover:text-red-500 transition-none text-shadow-pixel footer-link">WIKI</a></li>
                        </ul>
                    </div>
                    <!-- Social Media Links -->
                    <div>
                        <h3 class="text-xl mb-5 text-white text-shadow-pixel">FOLLOW US</h3>
                        <div class="flex justify-center md:justify-start space-x-6">
                            <a href="#" class="text-gray-400 hover:text-red-500 text-3xl transition-none"><i class="fab fa-twitter"></i></a>
                            <a href="#" class="text-gray-400 hover:text-red-500 text-3xl transition-none"><i class="fab fa-youtube"></i></a>
                            <a href="#" class="text-gray-400 hover:text-red-500 text-3xl transition-none"><i class="fab fa-twitch"></i></a>
                            <a href="#" class="text-gray-400 hover:text-red-500 text-3xl transition-none"><i class="fab fa-discord"></i></a>
                        </div>
                    </div>
                </div>
                <!-- Copyright information -->
                <div class="border-t-2 border-gray-800 mt-16 pt-8 text-center text-gray-600 text-sm text-shadow-pixel">
                    <p>© 2023 UNDERTALE FAN SITE. HAPPY BIRTHDAY QUACKERS! THIS IS A FAN-MADE WEBSITE AND IS NOT AFFILIATED WITH TOBY FOX OR UNDERTALE.</p>
                </div>
            </div>
        </footer>
    </div>

    <script>
        // --- Mobile Menu Toggle ---
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');

        mobileMenuButton.addEventListener('click', function() {
            mobileMenu.classList.toggle('hidden');
        });

        // --- Music Player Logic ---
        const nowPlayingTrackName = document.getElementById('now-playing-track-name');
        const nowPlayingArtist = document.getElementById('now-playing-artist'); // New element for artist
        const trackImage = document.getElementById('track-image');
        const progressBar = document.getElementById('progress-bar');
        const progressBarWrapper = document.getElementById('progress-bar-wrapper'); // Wrapper for seeking
        const currentTimeDisplay = document.getElementById('current-time');
        const totalTimeDisplay = document.getElementById('total-time');
        const togglePlayPauseButton = document.getElementById('toggle-play-pause');
        const prevTrackButton = document.getElementById('prev-track-button');
        const nextTrackButton = document.getElementById('next-track-button');
        const playTrackButtons = document.querySelectorAll('.play-track-button');
        const volumeSlider = document.getElementById('volume-slider'); // New volume slider
        // const visualizer = document.getElementById('visualizer'); // Visualizer container - removed

        // Define tracks (name, image URL, and audio URL)
        const tracks = [
            { name: "ONE SOUL, ONE CAKE", artist: "DOOFY & QUACKERS", imageUrl: "UT13.png", audioUrl: "UM1.mp3" },
            { name: "QUACKSTEP WALTZ", artist: "DOOFY & QUACKERS", imageUrl: "UT12.png", audioUrl: "UM2.mp3" },
            { name: "DISH DUTY HERO", artist: "DOOFY & QUACKERS", imageUrl: "UT11.png", audioUrl: "UM3.mp3" },
            { name: "FEATHER VS FLUFF", artist: "DOOFY & QUACKERS", imageUrl: "UT10.png", audioUrl: "UM4.mp3" },
            { name: "DUAL SOUL MODE", artist: "DOOFY & QUACKERS", imageUrl: "UT9.png", audioUrl: "UM5.mp3" }
        ];

        let currentTrackIndex = -1;
        let isPlaying = false;
        let audio = new Audio(); // Create a single Audio object

        // Event listener for when the audio ends
        audio.addEventListener('ended', () => {
            isPlaying = false;
            updateMusicPlayerUI();
            // visualizer.classList.add('paused'); // Pause visualizer - removed
            playNextTrack(); // Automatically play the next track
        });

        // Event listener for when audio metadata is loaded (to get duration)
        audio.addEventListener('loadedmetadata', () => {
            updateMusicPlayerUI();
        });

        // Event listener for audio time updates (for progress bar)
        audio.addEventListener('timeupdate', () => {
            updateMusicPlayerUI();
        });

        // Event listener for when audio starts playing
        audio.addEventListener('play', () => {
            // visualizer.classList.remove('paused'); // Resume visualizer - removed
        });

        // Event listener for when audio is paused
        audio.addEventListener('pause', () => {
            // visualizer.classList.add('paused'); // Pause visualizer - removed
        });

        /**
         * Formats seconds into MM:SS string.
         * @param {number} seconds - The total seconds.
         * @returns {string} Formatted time string.
         */
        function formatTime(seconds) {
            if (isNaN(seconds) || seconds < 0) return '0:00'; // Handle invalid time
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = Math.floor(seconds % 60);
            return `${minutes}:${remainingSeconds < 10 ? '0' : ''}${Math.floor(remainingSeconds)}`;
        }

        /**
         * Updates the music player UI based on the current track and audio state.
         */
        function updateMusicPlayerUI() {
            if (currentTrackIndex === -1 || !tracks[currentTrackIndex]) {
                nowPlayingTrackName.textContent = "SELECT A TRACK TO PLAY";
                nowPlayingArtist.textContent = "DOOFY & QUACKERS";
                trackImage.src = "https://placehold.co/250x250/000/FFF?text=TRACK"; // Default image
                trackImage.alt = "DEFAULT TRACK IMAGE";
                progressBar.style.width = '0%';
                currentTimeDisplay.textContent = '0:00';
                totalTimeDisplay.textContent = '0:00';
                togglePlayPauseButton.innerHTML = '<i class="fas fa-play"></i>';
                // visualizer.classList.add('paused'); // Ensure visualizer is paused when no track - removed
                return;
            }

            const currentTrack = tracks[currentTrackIndex];
            nowPlayingTrackName.textContent = currentTrack.name;
            nowPlayingArtist.textContent = currentTrack.artist;
            trackImage.src = currentTrack.imageUrl;
            trackImage.alt = currentTrack.name + " IMAGE";
            
            currentTimeDisplay.textContent = formatTime(audio.currentTime);
            totalTimeDisplay.textContent = formatTime(audio.duration);

            const progressPercentage = (audio.currentTime / audio.duration) * 100;
            progressBar.style.width = `${progressPercentage || 0}%`; // Handle NaN for duration

            if (isPlaying) {
                togglePlayPauseButton.innerHTML = '<i class="fas fa-pause"></i>';
                // visualizer.classList.remove('paused'); - removed
            } else {
                togglePlayPauseButton.innerHTML = '<i class="fas fa-play"></i>';
                // visualizer.classList.add('paused'); - removed
            }
        }

        /**
         * Plays the specified track.
         * @param {number} index - The index of the track to play.
         */
        function playTrack(index) {
            if (index < 0 || index >= tracks.length) {
                console.error("INVALID TRACK INDEX:", index);
                return;
            }

            // If a track is currently playing, pause it before changing
            if (isPlaying) {
                audio.pause();
            }

            currentTrackIndex = index;
            audio.src = tracks[currentTrackIndex].audioUrl;
            audio.load(); // Load the new audio source
            audio.play().then(() => {
                isPlaying = true;
                updateMusicPlayerUI();
            }).catch(error => {
                console.error("ERROR PLAYING AUDIO:", error);
                isPlaying = false;
                updateMusicPlayerUI();
                showCustomMessage("COULD NOT PLAY AUDIO. PLEASE CHECK THE FILE PATHS (UM1.mp3 to UM5.mp3 and UT9.png to UT13.png)."); 
            });
        }

        /**
         * Toggles play/pause state.
         */
        function togglePlayPause() {
            if (currentTrackIndex === -1) {
                // If no track selected, play the first one
                playTrack(0);
                return;
            }

            if (isPlaying) {
                audio.pause();
            } else {
                audio.play().then(() => {
                    // Successfully played
                }).catch(error => {
                    console.error("ERROR RESUMING AUDIO:", error);
                    showCustomMessage("COULD NOT RESUME AUDIO. PLEASE CHECK THE FILE PATHS.");
                });
            }
            isPlaying = !isPlaying;
            updateMusicPlayerUI();
        }

        /**
         * Plays the next track in the list.
         */
        function playNextTrack() {
            let nextIndex = currentTrackIndex + 1;
            if (nextIndex >= tracks.length) {
                nextIndex = 0; // Loop back to the first track
            }
            playTrack(nextIndex);
        }

        /**
         * Plays the previous track in the list.
         */
        function playPreviousTrack() {
            let prevIndex = currentTrackIndex - 1;
            if (prevIndex < 0) {
                prevIndex = tracks.length - 1; // Loop to the last track
            }
            playTrack(prevIndex);
        }

        // Add event listeners to "Play" buttons in the track list
        playTrackButtons.forEach(button => {
            button.addEventListener('click', function() {
                const trackIndex = parseInt(this.dataset.trackIndex);
                playTrack(trackIndex);
            });
        });

        // Add event listeners to music player controls
        togglePlayPauseButton.addEventListener('click', togglePlayPause);
        prevTrackButton.addEventListener('click', playPreviousTrack);
        nextTrackButton.addEventListener('click', playNextTrack);

        // Volume control
        volumeSlider.addEventListener('input', () => {
            audio.volume = volumeSlider.value;
        });

        // Progress bar seeking
        progressBarWrapper.addEventListener('click', (e) => {
            const clickX = e.offsetX; // X position of the click relative to the element
            const width = progressBarWrapper.offsetWidth; // Total width of the progress bar
            const seekTime = (clickX / width) * audio.duration;
            if (!isNaN(seekTime)) { // Ensure seekTime is a valid number
                audio.currentTime = seekTime;
            }
        });

        // --- Next Adventure Button Logic ---
        const nextAdventureButton = document.getElementById('next-adventure-button');
        nextAdventureButton.addEventListener('click', function() {
            // Placeholder for next adventure, could be another game or section
            showCustomMessage("THE NEXT ADVENTURE AWAITS! (Feature not yet implemented)");
        });

        // Initial UI update for music player
        updateMusicPlayerUI();

        // --- Typewriter effect for hero section title ---
        const heroTextElement = document.querySelector('.typing-effect-pixel');
        if (heroTextElement) {
            let fullText = heroTextElement.textContent;
            heroTextElement.textContent = ''; // Clear text initially
            let i = 0;
            const speed = 70; // Typing speed in milliseconds per character

            function typeWriter() {
                if (i < fullText.length) {
                    heroTextElement.textContent += fullText.charAt(i);
                    i++;
                    setTimeout(typeWriter, speed);
                } else {
                    heroTextElement.style.borderRight = 'none'; // Stop blinking caret after typing
                }
            }
            typeWriter();
        }

        // --- Custom Message Box (replaces alert) ---
        function showCustomMessage(message) {
            const messageBox = document.createElement('div');
            messageBox.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background-color: rgba(0, 0, 0, 0.95);
                border: 2px solid white;
                padding: 20px;
                color: white;
                font-family: 'Press Start 2P', cursive;
                text-align: center;
                z-index: 1000;
                box-shadow: 4px 4px 0px rgba(255,255,255,0.2);
                border-radius: 0;
            `;
            messageBox.innerHTML = `
                <p class="text-lg mb-4">${message}</p>
                <button class="game-button px-6 py-3" onclick="this.parentNode.remove()">OK</button>
            `;
            document.body.appendChild(messageBox);
        }

        // --- Expandable Character Card Logic ---
        document.querySelectorAll('.character-card').forEach(card => {
            const bioContainer = card.querySelector('.character-bio-container');
            const toggleButton = card.querySelector('.toggle-bio'); // The paragraph containing "Read More/Show Less"

            // Ensure the initial state is collapsed
            if (!bioContainer.classList.contains('expanded')) {
                toggleButton.innerHTML = '...READ MORE <i class="fas fa-chevron-down toggle-icon"></i>';
            }

            card.addEventListener('click', (event) => {
                // Prevent clicks on inner elements (like links or buttons if they were there) from triggering toggle
                if (event.target.tagName === 'A' || event.target.tagName === 'BUTTON') {
                    return;
                }
                
                bioContainer.classList.toggle('expanded');
                const icon = toggleButton.querySelector('i');

                if (bioContainer.classList.contains('expanded')) {
                    toggleButton.innerHTML = '...SHOW LESS <i class="fas fa-chevron-up toggle-icon"></i>';
                } else {
                    toggleButton.innerHTML = '...READ MORE <i class="fas fa-chevron-down toggle-icon"></i>';
                }
            });
        });

        // --- Save Point Interaction ---
        const savePointButton = document.getElementById('save-point-button');
        if (savePointButton) {
            savePointButton.addEventListener('click', () => {
                showCustomMessage("GAME SAVED! Your progress (and butterscotch pie) is safe!");
            });
        }
    </script>
</body>
</html>
